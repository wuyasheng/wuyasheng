---
title: 静态时序分析基础
author: yasheng
img: /medias/featureimages/fpga.jpg
toc: true
mathjax: true
summary: 本文整理静态时序分析基础
categories: ☸ FPGA
tags:
  - FPGA
  - 静态时序分析
abbrlink: 2958501227
date: 2020-06-19 10:10:09
layout:
password:
---

## 静态时序分析基础

---

注 : 本文内容总结至《FPGA之路》、《集成电路静态时序分析与建模》

### 1  逻辑门单元

​	逻辑门单元是实现基本逻辑运算和复合逻辑运算的单元电路。逻辑门单元分为组合逻辑门单元和时序逻辑门单元两种。CMOS工艺下，数字电路逻辑门单元主要由PMOS和NMOS晶体管构成。反相器逻辑门单元如图所示。
​	反相器逻辑门的逻辑功能是根据输入数据的逻辑电平进行逻辑取反的求值运算，并通过输出导出求值结果。其输出结果有两个状态:高电平和低电平，分别对应数字逻辑的1和0。
​	时序分析中逻辑门延时和信号线延时这两个参数值组成的阶段延时( stage delay)是时序分析中计算延时的主要组成部分，如图所示。

<img src="/images/post_images/fpga_12_static_timing_analysis/fpga_12_static_timing_analysis_01.png">

​	逻辑门延时定义为逻辑单元自身逻辑求值的时间。不同的逻辑门单元对应不同的逻辑门延时，那么反相器逻辑门单元自身的求值时间就对应该反相器的逻辑门延时。**信号线延时的定义为:逻辑信号从逻辑门单元的输出端口开始在互连线上传播到下一级逻辑输入端口的延时。**

### 2 门单元的时序计算参数

#### 2.1 信号转换延迟

​	输入端口或者输出端口的信号电平由高电平转换成低电平，或者由低电平转换成高电平所需要的时间即为信号转换延时。

#### 2.2 逻辑门延时( logic gate delay)

通过由晶体管组成的逻辑门可以使高、低电平输入信号进行逻辑求值并产生对应的高电平或者低电平信号输出，而从输入信号改变到对应的正确输出信号的时间间隔即为逻辑门延时。

<img src="/images/post_images/fpga_12_static_timing_analysis/fpga_12_static_timing_analysis_02.png">

### 3  时序单元相关约束

相比组合逻辑单元，时序单元除了具有组合逻辑单元的时序参数属性，还存在更多的时序约束参数属性，这些都是时序单元特有的相关时序约束。时序单元的时序约束是为了保证时序单元能够实现正确的逻辑功能所规定的输人或者输出信号数据需要保持稳定的最小时间间隔值。时序单元相关约束信息包括:**建立时间、保持时间、恢复时间、移除时间及最小脉冲宽度**。

<img src="/images/post_images/fpga_12_static_timing_analysis/fpga_12_static_timing_analysis_03.png">

#### 3.1 建立时间

​	对于时序单元，建立时间是指时序单元正常工作时，在功能上为了保证正确性，输入信号数据应该在时钟信号有效前到达并保持的最小时间。根据前面介绍的单元时序计算参数设置，计算建立时间的有效值需要根据单元时序计算参数的设置进行。根据设计的不同需求，设计者可以设置不同的单元时序计算百分比参数，一般设置为50%。
​	**建立时间的测量值定义为:从数据信号的电压达到标准供电电压50%时间点到时钟信号电压达到标准供电电压50%时间点的时间间隔**

<img src="/images/post_images/fpga_12_static_timing_analysis/fpga_12_static_timing_analysis_04.png">

**建立时间约束**

<img src="/images/post_images/fpga_12_static_timing_analysis/fpga_12_static_timing_analysis_05.png">
$$
T_{clk1}+T_{co}+T_{data}<= T_{clk} +T_{clk2}-T_{su}
$$
也可以转化为
$$
T_{co}+T_{data}+T_{su}<=T_{clk}+T_{skew}
$$

$$
其中(T_{skew} = T_{clk2}-T_{clk1})
$$



#### 3.2 保持时间

对于时序单元，保持时间是指时序单元要实现正确的逻辑功能，数据信号在时钟沿有效后必须保持的最小时间长度。同样，计算保持时间的测量值也需要根据单元时序计算参数白设置进行。根据设计的不同需求，设计者可以设置不同的单元时序计算百分比参数，一般设置为50%。
如图所示，保持时间的测量值定义为:从时钟信号电压达到标准供电电压50%时点到数据信号的电压达到标准供电电压50%时间点的时间间隔。

<img src="/images/post_images/fpga_12_static_timing_analysis/fpga_12_static_timing_analysis_06.png">

**保持时间约束**

<img src="/images/post_images/fpga_12_static_timing_analysis/fpga_12_static_timing_analysis_07.png">
$$
T_{clk1}+T_{co}+T_{data} >= T_{clk2}+T_{hold}
$$
也可以转换成
$$
T_{co}+T_{data}>=T_{hold}+T_{skew}
$$

$$
其中T_{skew} = T_{clk2}-T_{clk1}
$$

#### 3.3 恢复时间

恢复时间是指为了保证单元正确的逻辑功能，要求低电平复位信号或者高电平清零信号在时钟有效沿之前保持有效的最小时间长度。同样，计算恢复时间的测量值也需要根据单元时序计算参数的设置进行。根据设计的不同需求，设计者可以设置不同的时序计算百分比参数，一般设置为50%
如图所示，恢复时间的测量值定义为:从复位或清零信号的电压达到标准供电电压50%时间点到时钟信号电压达到标准供电电压50%时间点的时间间隔。

<img src="/images/post_images/fpga_12_static_timing_analysis/fpga_12_static_timing_analysis_08.png">

#### 3.4 移除时间

移除时间是指为了保证单元正确的逻辑功能，要求低电平复位信号或者高电平清零信号在时钟有效沿之后继续保持有效的最小时间长度。同样，计算移除时间的测量值也需要根据单元时序参数设置进行。根据设计的不同需求，设计者可以设置不同的时序计算百分比参数，一般设置为50%。
如图所示，移除时间的测量值定义为:从时钟信号电压达到标准供电电压50%时间点到复位或清零信号的电压达到标准供电电压50%时间点的时间间隔。

<img src="/images/post_images/fpga_12_static_timing_analysis/fpga_12_static_timing_analysis_09.png">



#### 3.5 最小脉冲宽度

最小脉冲宽度是指脉冲波形的开始到结束之间的最小时间间隔。同样，计算最小脉冲宽度的测量值也需要根据单元时序计算参数的设置进行。根据设计的不同需求，设计者可以设置不同的单元时序计算百分比参数，一般设置为50%。
如图所示，最小高电平脉冲宽度测量值为:信号的上升沿电压达到标准供电电压50%的时间点到相邻的信号电压下降沿达到标准供电电压50%的时间点的时间间隔。最小低电平脉冲宽度测量值为:信号的下降沿电压达到标准供电电压50%的时间点到相邻的信号电压上升沿达到标准供电电压50%的时间点的时间间隔。

**时序单元的时序分析必须满足输入信号脉宽大于最小脉冲宽度的要求，否则时序分析结果就可能与实际情况不一致，主要原因之一就是无法保证时序单元实现正常的逻辑功能。**

<img src="/images/post_images/fpga_12_static_timing_analysis/fpga_12_static_timing_analysis_10.png">



### 4 时钟特性

时钟的时序特性主要分为时钟周期( clock period)、时钟占空比( clock duty cycle)、时钟转换时间( clock transition time)、时钟延迟( clock latency)、时钟偏斜( clock skew)和时钟抖动( clock jitter）

#### 4.1 时钟周期

静态时序分析中需要设置时钟周期即时钟信号的工作频率，作为时序参考基础，来检查时序路径是否满足时序要求。时钟周期为时钟频率的倒数。

#### 4.2 时钟占空比

时钟占空比是指时钟信号高电平在一个周期之内所占的时间比率，如图所示。一般设计中，大部分的时钟占空比为50%，即占空比为0.5,说明高、低电平所占时间都为0.5个周期。但根据设计需要，也可以设计占空比不同的时钟信号。

<img src="/images/post_images/fpga_12_static_timing_analysis/fpga_12_static_timing_analysis_11.png">

#### 4.3 时钟转换时间

理想情况下,时钟信号在不同电平之间进行切换是不需要时间的,但是实际时钟信号在不同电平之间切换时,由于供电电压、工艺变化、扇出负载大小和互连负载大小等因素,是需要转换时间的。因此,时钟转换时间一般定义为时钟信号的电压从标准供电电源电压的10%变化到标准供电电源电压的90%的时间间隔。根据设计的不同需求,设计者可以通过单元时序计算参数来定义不同的时钟转换时间参数。
由于时钟转换时间分为上升和下降两种情况,应该使上升和下降转换的时间保持对称性。基于时钟信号输出上升和下降转换的时间保持对称性的需要,时钟转换时间越短,而且不同切换形式下越对称,那么时钟信号质量越好。

#### 4.4 时钟延迟

时钟延迟是指时钟信号从时钟源输出端口到达时序单元时钟输入端口所需要的传播时间,由于OCV(片上工艺偏差)和PVT( process(工艺)、 voltage(电压) temperature(温度)等因素会不同幅度地影响时钟输入的延时不确定性,从而导致整个设计时序的不确定。**所以时钟输入延时越短,时钟树性能越好,这样可以减少其他外在因素对时钟树性能的影响。**

<img src="/images/post_images/fpga_12_static_timing_analysis/fpga_12_static_timing_analysis_12.png">

#### 4.5 时钟偏斜

非理想情况下,由于时钟线长度及时钟树叶节点负载不同等因素,导致时钟信号到达同一时序路径下的相邻两个时序单元时钟端口的时间并不相同,这种时钟信号之间的偏移就是相同时钟信号之间的时钟偏斜。

<img src="/images/post_images/fpga_12_static_timing_analysis/fpga_12_static_timing_analysis_13.png">

#### 4.6 时钟抖动

芯片工作过程中通常都是根据系统时钟脉冲信号同步工作的。最理想的情况是,时钟输入信号在下一个时钟的有效电平或者信号边缘到来之前切换,并在其正确的逻辑电平上保持稳定,从而使整个电路系统的行为合乎预设。但是在时钟电路设计实现中,不同实现单元的速度在不同时刻可能有着大小不一的差别,时钟信号可能并不能准确地在理想的信号边缘到来之前的瞬间保持在其正确的信号值上,它保持稳定所需的时间比理想情况有一定的偏移,这种偏移是在同一个时序单元的时钟输入端口上的时钟偏移。该时钟偏移主要表现为时钟抖动。

<img src="/images/post_images/fpga_12_static_timing_analysis/fpga_12_static_timing_analysis_14.png">

时钟信号边沿变化的不确定时间称之为时钟抖动。严格说，建立时间应该是Tsu + T1，而保持时间应该是Th + T2。

​               

​                

[  完  ]